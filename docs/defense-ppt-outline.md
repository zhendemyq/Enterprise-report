# 企业报表生成系统 - 毕业答辩PPT大纲

> 制作日期：2025年12月23日  
> 项目名称：企业报表生成系统  
> 建议页数：25-30页

---

## 一、引言（约2页）

### 1.1 自我介绍页
- 姓名、学号、指导老师
- 毕业设计题目：**企业报表生成系统**

### 1.2 目录页
- 研究背景与意义
- 需求分析
- 系统设计
- 核心功能实现
- 系统测试
- 总结与展望

---

## 二、研究背景与意义（约3页）

### 2.1 选题背景
- 企业数据报表需求日益增长
- 传统报表开发周期长、维护成本高
- 缺乏统一的报表管理平台

### 2.2 现有方案分析

| 方案 | 优点 | 缺点 |
|------|------|------|
| Excel手工处理 | 简单易用 | 效率低、易出错 |
| 商业BI工具 | 功能强大 | 成本高、定制难 |
| 自建系统 | 灵活可控 | 开发周期长 |

### 2.3 研究意义
- 提供一站式报表管理解决方案
- 支持多数据源接入
- 定时任务自动化生成
- 降低企业报表开发成本

---

## 三、需求分析（约3页）

### 3.1 功能需求
- **用户管理**：登录、注册、权限分配
- **数据源管理**：MySQL/PostgreSQL/Oracle/SQLServer/API接口
- **模板管理**：在线设计、发布/下线、版本控制
- **报表生成**：Excel/PDF导出、同步/异步生成
- **定时任务**：Cron调度、邮件自动推送
- **分类管理**：树形结构分类
- **Dashboard**：统计卡片、趋势图

### 3.2 非功能需求
- **性能要求**：10万行数据处理 < 30秒
- **并发要求**：支持100并发用户
- **安全要求**：RBAC权限控制

### 3.3 用例图
- 主要角色：管理员、报表设计师、业务用户

---

## 四、系统设计（约5页）

### 4.1 系统架构设计

```
┌─────────────────────────────────────────────────────┐
│                    前端层                           │
│      Vue 3 + Element Plus + ECharts + Univer       │
├─────────────────────────────────────────────────────┤
│                    接口层                           │
│            Spring Boot RESTful API                  │
├─────────────────────────────────────────────────────┤
│                    业务层                           │
│      报表生成 │ 模板管理 │ 定时任务 │ 权限控制       │
├─────────────────────────────────────────────────────┤
│                    数据层                           │
│         MyBatis Plus │ Redis │ 多数据源            │
├─────────────────────────────────────────────────────┤
│                    调度层                           │
│                  XXL-JOB                            │
└─────────────────────────────────────────────────────┘
```

### 4.2 技术栈选型

| 层级 | 技术选型 | 版本 |
|------|----------|------|
| 前端框架 | Vue 3 + Vite | 3.4.0 / 5.0.10 |
| UI组件 | Element Plus | 2.4.4 |
| 状态管理 | Pinia | 2.1.7 |
| 后端框架 | Spring Boot | 3.2.0 |
| ORM框架 | MyBatis Plus | 3.5.5 |
| 认证授权 | Sa-Token | 1.37.0 |
| Excel处理 | EasyExcel + POI | 3.3.3 / 5.2.5 |
| PDF生成 | iText7 | 7.2.5 |
| 任务调度 | XXL-JOB | 2.4.0 |
| 缓存 | Redis | 6.x |
| 数据库 | MySQL | 8.0 |

### 4.3 数据库设计（E-R图）

核心表：
- `sys_user` - 用户表
- `sys_role` - 角色表
- `report_template` - 报表模板表
- `report_datasource` - 数据源表
- `report_record` - 生成记录表
- `report_schedule` - 定时任务表
- `report_permission` - 权限表

### 4.4 模块划分

```
backend/
├── controller/     # 控制器层（13个）
├── service/        # 服务层（14个）
├── entity/         # 实体类（12个）
├── mapper/         # 数据访问层
├── config/         # 配置类
├── job/            # 定时任务
└── common/         # 公共组件

frontend/
├── views/          # 页面组件
│   ├── dashboard/  # 首页仪表盘
│   ├── report/     # 报表管理
│   ├── datasource/ # 数据源管理
│   ├── schedule/   # 定时任务
│   └── system/     # 系统管理
├── components/     # 公共组件
├── api/            # 接口封装
└── stores/         # 状态管理
```

---

## 五、核心功能实现（约8页）

### 5.1 用户认证与权限控制
- **Sa-Token** 实现登录认证
- **RBAC** 权限模型
- 角色：ADMIN / REPORT_MANAGER / REPORT_USER
- 前端路由守卫 + 后端权限校验

### 5.2 多数据源管理
- 支持5种数据源类型
- 动态数据源连接池（HikariCP）
- 连接测试与状态监控
- SQL执行与结果预览
- 关键代码展示：`ReportDatasourceServiceImpl`

### 5.3 报表模板设计器
- **Univer** 在线表格组件集成
- 单元格样式配置
- 字段拖拽绑定
- 设计数据JSON序列化
- 截图展示：设计器界面

### 5.4 报表生成引擎
- **EasyExcel** 高性能Excel导出
- **Jxls** 模板引擎
- **iText7** Excel转PDF
- 同步/异步生成模式
- 分页查询大数据量处理（pageSize=5000）

### 5.5 定时任务调度
- **XXL-JOB** 分布式任务调度
- Cron表达式支持
- 任务执行日志
- 邮件自动推送
- 关键代码展示：`ReportScheduleJobHandler`

### 5.6 邮件通知服务
- Spring Boot Mail
- HTML邮件模板
- 附件支持（压缩大文件）
- 多收件人批量发送

### 5.7 Dashboard仪表盘
- ECharts可视化图表
- 报表生成趋势
- 热门模板排行
- 实时统计卡片

---

## 六、系统测试（约3页）

### 6.1 测试环境

| 项目 | 配置 |
|------|------|
| JDK | 17 |
| MySQL | 8.0 |
| Redis | 6.x |
| 内存 | 8GB+ |

### 6.2 功能测试结果

| 模块 | 测试用例 | 通过率 |
|------|----------|--------|
| 用户管理 | 8 | 100% |
| 模板管理 | 8 | 100% |
| 数据源管理 | 7 | 100% |
| 报表生成 | 6 | 100% |
| 定时任务 | 6 | 100% |

### 6.3 性能测试结果

| 数据量 | 查询耗时 | 导出耗时 | 吞吐量 |
|--------|----------|----------|--------|
| 1万行 | < 3s | < 5s | > 2,000行/秒 |
| 10万行 | < 30s | < 30s | > 3,500行/秒 |

### 6.4 并发测试
- 100并发用户，成功率 > 99%
- 平均响应时间 < 1秒

---

## 七、系统演示（约2页）

### 7.1 演示要点
1. 用户登录 / 权限切换
2. 数据源创建与测试连接
3. 模板设计器使用
4. 报表生成（Excel/PDF）
5. 定时任务配置
6. Dashboard数据展示

### 7.2 系统截图
- 登录页面
- 首页仪表盘
- 模板设计器
- 报表生成页面
- 定时任务管理

---

## 八、总结与展望（约2页）

### 8.1 完成工作总结
- ✅ 完成用户管理、RBAC权限控制
- ✅ 实现多数据源（5种类型）管理
- ✅ 集成在线报表设计器
- ✅ 支持Excel/PDF多格式导出
- ✅ 集成XXL-JOB定时任务调度
- ✅ 实现邮件自动推送
- ✅ 10万行数据处理性能达标

### 8.2 项目特色与创新点
1. **一站式报表平台**：从数据源到报表生成全流程管理
2. **可视化设计器**：基于Univer的在线表格设计
3. **高性能导出**：EasyExcel分批写入，支持大数据量
4. **分布式调度**：XXL-JOB实现可靠的定时任务

### 8.3 不足与展望
- 预留SSO单点登录接口（待实现）
- LDAP认证集成（待实现）
- 报表审批流程（规划中）
- 更丰富的图表组件

### 8.4 个人收获
- 掌握Spring Boot 3.x新特性
- Vue 3 Composition API实践
- 分布式任务调度设计
- 大数据量处理优化

---

## 九、致谢（1页）

感谢指导老师的悉心指导，感谢实验室同学的帮助...

---

## 十、答辩Q&A准备

### 可能被问到的问题：

**1. 为什么选择Sa-Token而不是Spring Security？**
> 轻量级、API简洁、学习曲线低、适合中小型项目

**2. 如何处理10万行数据的导出？**
> EasyExcel分批写入、pageSize=5000分页查询、避免OOM

**3. XXL-JOB与Spring @Scheduled的区别？**
> 分布式支持、任务可视化管理、失败重试、日志追踪

**4. 多数据源连接如何管理？**
> HikariCP连接池缓存、按需创建、超时回收

**5. 前端报表设计器的实现原理？**
> 基于Univer组件，设计数据序列化为JSON存储

**6. 系统如何保证权限安全？**
> 前端路由守卫 + 后端Sa-Token注解校验 + 数据权限过滤

**7. 如何确保定时任务的可靠执行？**
> XXL-JOB调度中心、执行日志记录、失败重试机制、邮件告警

**8. 项目中遇到的最大技术难点是什么？**
> 大数据量Excel导出的内存优化、Excel转PDF样式保持

---

## PPT制作建议

### 设计风格
- 简洁专业，蓝色/深色主题
- 统一字体：标题用黑体，正文用微软雅黑
- 每页内容不超过6个要点

### 图表建议
- 系统架构图（必须）
- E-R图（数据库设计）
- 时序图（核心流程）
- 系统截图（功能演示）

### 时间分配（15分钟）
| 章节 | 时间 |
|------|------|
| 背景与意义 | 2分钟 |
| 需求分析 | 2分钟 |
| 系统设计 | 3分钟 |
| 核心功能 | 4分钟 |
| 测试结果 | 2分钟 |
| 总结展望 | 2分钟 |

### 演示准备
- 提前启动后端服务、前端服务、XXL-JOB
- 准备测试账号（admin/designer/user）
- 准备测试数据源和模板
- 录制备用演示视频（以防现场出问题）

---

**祝答辩顺利！🎓**
